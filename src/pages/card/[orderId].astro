---
import Layout from '../../layouts/Layout.astro';
import MainContent from '../../components/react/contectClient/MainContent';

const { orderId } = Astro.params;

let orderData = null;
let metaTags = {
  title: "Letra Viva - Tu Canción Personalizada",
  description: "Descubre tu canción personalizada creada especialmente para ti",
  image: "/og-image.jpg"
};

try {
  const response = await fetch(`${Astro.url.origin}/api/order/${orderId}`);
  if (response.ok) {
    orderData = await response.json();
    
    metaTags = {
      title: `${orderData.metafields.titulo_cancion} - Letra Viva`,
      description: `Canción Personalizada ${orderData.metafields.para_quien_es} De ${orderData.metafields.de_quien_es}`,
      image: orderData.metafields.targeta_digital_url || "/og-image.jpg"
    };
  }
} catch (error) {
  console.error('Error fetching order data for meta tags:', error);
}
---

<Layout 
  title={metaTags.title}
  description={metaTags.description}
  image={metaTags.image}
  url={Astro.url.href}
>
  <MainContent client:load />
</Layout>